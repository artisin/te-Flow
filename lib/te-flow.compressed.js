!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("lodash.isfunction"),require("lodash.isobject"),require("lodash.memoize"),require("lodash.defaults"),require("defclass")):"function"==typeof define&&define.amd?define(["lodash.isfunction","lodash.isobject","lodash.memoize","lodash.defaults","defclass"],t):"object"==typeof exports?exports.teFlow=t(require("lodash.isfunction"),require("lodash.isobject"),require("lodash.memoize"),require("lodash.defaults"),require("defclass")):r.teFlow=t(r["lodash.isfunction"],r["lodash.isobject"],r["lodash.memoize"],r["lodash.defaults"],r.defclass)}(this,function(r,t,s,e,n){return function(r){function t(e){if(s[e])return s[e].exports;var n=s[e]={exports:{},id:e,loaded:!1};return r[e].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var s={};return t.m=r,t.c=s,t.p="",t(0)}([function(r,exports,t){"use strict";function s(r){return Array.isArray(r)?r:Array.from(r)}var e=t(1),n=t(2),i=t(3),o=t(4),a=t(5),p=a({constructor:function(r){var t=this;if(t._self=t,t.userOptions={},r){var s=["initArgs","args","this","stream","objReturn","objKeep","flow","flatten","start","res","end"];s.forEach(function(s){t._L.isUdf(r[s])||(t.userOptions[s]=r[s])}),t._L.isUdf(r.memoize)||(t._memoize=r.memoize)}},invoke:function(){for(var r=this,t=new Array(arguments.length),s=0;s<t.length;++s)t[s]=arguments[s];if(r.args=t,r.argsToApply={_fnArgs:[]},!r.count){r.count=1;var e=r.checkOpts(r.args);r.args=e.args,r.argsToApply=e.argsToApply}r.first=r.args.length?r.args.shift():null,r.rest=r.args,r.firstIsFn=r._L.isFn(r.first),r.firstIsUdf=r._L.isUdf(r.first);var n=r.rest[r.rest.length-1];return!r._L.isUdf(n)&&n._fnArgs&&(r.argsToApply._fnArgs=r.rest.pop()._fnArgs),r.process()},checkOpts:function(r){var t=this,s=Object.keys(t.userOptions),e=r[0],n=t._L.isFn(e)?!1:t._L.isObj(e),i=["_stream","_objReturn","_objKeep","_flow","_args","_flatten","_start","_res","_end","_option","_this"],o=!1;if(n){e=e._option?e._option:e;for(var a=Object.keys(e),p=0;p<a.length&&!o;p++)-1!==i.indexOf(a[p])&&(o=!0)}t.streamOpt=[];var u=function(r,s,n){return t._L.isUdf(t.userOptions[r])?t._L.isUdf(e[s])?n:e[s]:t.userOptions[r]};if(t.optList={_kill:u("kill","_kill",!1),_return:u("return","_return",!1),_stream:u("stream","_stream",!0),_objReturn:u("objReturn","_objReturn",!0),_objKeep:u("objKeep","_objKeep",!1),_flow:u("flow","_flow",!1),_flatten:u("flatten","_flatten",!1)},t.optStreamList={_start:u("start","_start",null),_res:u("res","_res",null),_end:u("end","_end",null)},n&&o||s.length){t.userOptions["this"]?t._this=t.userOptions["this"]:t._this=e._this?e._this:null;var f=function(r){return t._L.isFn(r)?r():Object.keys(r).reduce(function(s,e){var n=r[e];return s[e]=t._L.isFn(n)?n():r[e],s},{})};if(t.userOptions.initArgs||t.userOptions.args){var l=t.userOptions.args||t.userOptions.initArgs;t.applyArgs(f(l),!0)}else e._args?t.applyArgs(f(e._args),!0):e._initArgs&&t.applyArgs(f(e._initArgs),!0);t._memoize||(t._memoize=e._memoize===!1?!1:!0),Object.keys(t.optStreamList).forEach(function(r){e[r]&&(t.streamOpt.push(r),null===t.optStreamList[r]&&(t.optStreamList[r]=e[r]))}),s.length||r.shift()}return{args:r,argsToApply:t.argsToApply}},applyOpts:function(r,t){var e=this,n=function(r,t){for(var n=!0;n;){var i=r,o=t;n=!1;var a=s(o),p=a[0],u=a.slice(1);if(void 0===i)return;if(e._L.isArr(i)||(i=[i]),void 0===p)return i;r=p.apply(e._this,i),t=u,n=!0,a=p=u=void 0}},i=function(r,t){var s=e._L.memoize(function(r){return n(r,t)}),i=e._memoize?s:n;return r.map(function(r){var s=i(r,t);return!e._L.isUdf(s)&&s[0]?s[0]:void 0})},o=function(r,t){return e._L.isFn(t)?i(r,t):e._L.isObj(t)?i(r,Object.keys(t).map(function(r){return t[r]})):e._L.isArr(t)?i(r,t):void 0},a=function(r,t,s){return s=s.filter(function(r){return"_start"!==r&&"_res"!==r&&"_end"!==r?r:"_start"===r&&t._start?r:"_res"===r&&t._res?r:"_end"===r&&t._end?r:void 0}),s.reduce(function(r,t){return o(r,e.optStreamList[t])},r)},p=function(r,t,s){var n={_start:!1,_end:!1,_res:!1};return a.apply(e,[r,e._L.defaults(t,n),s])};return this.streamOpt.length?p(r,t,this.streamOpt):r},applyArgs:function(r){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],s=this,e=!1;if(void 0!==r){var n=function(r){s.optList._flow?s.argsToApply._fnArgs.push(r):s.optList._objReturn&&s._L.isObj(r)?!function(){var t=s.optList._objKeep;t=e?!t:t,s.argsToApply._fnArgs=Object.keys(r).map(function(s){var e=void 0;return t&&(e={},e[s]=r[s]),t?e:r[s]})}():(r=s._L.isArr(r)?r:[r],s.argsToApply._fnArgs=r)};t?n(r):!function(){var t=function(r){return s._L.isUdf(r)||(r._this&&(s._this=r._this,delete r._this),s._L.isUdf(r._objKeep)||(e=!0,delete r._objKeep),r._kill===!0&&(s.optList._kill=!0,delete r._kill),r._return===!0&&(s.optList._return=!0,delete r._return)),r};n(function(){if(!s._L.isArr(r)){r=[t(r)];var e=s.applyOpts(r,{_res:!0});return e[0]}return s.applyOpts(t(r),{_res:!0})}()),s.argsToApply._fnArgs=s.optList._flatten?s._L.flatten(s.argsToApply._fnArgs):s.argsToApply._fnArgs,s.argsToApply._fnArgs=s.applyOpts(s.argsToApply._fnArgs,{_end:!0})}()}},process:function(){var r=this;if(!r.optList._kill){if(r.optList._return){var t=r.rest[r.rest.length-1];return r._L.isObj(t)&&"return"===Object.keys(t)[0]?t["return"].apply(r._this,r.argsToApply._fnArgs||[]):r.argsToApply._fnArgs||[]}if(r.firstIsFn){var s=Object.keys(r.argsToApply).length?r.first.apply(r._this,r.applyOpts(r.argsToApply._fnArgs,{_start:!0})):r.first.call(r._this);return r.applyArgs(s),Object.keys(r.argsToApply).length&&r.rest.push(r.argsToApply),r.invoke.apply(r,r.rest)}if(r._L.isObj(r.first)&&r.first["return"]){var e=r.first["return"];return r._L.isFn(e)?e.apply(r._this,r.argsToApply._fnArgs||[]):e}return r._L.isObj(r.first)&&r.first._fnArgs?r.first._fnArgs.length?r.first._fnArgs:void 0:r.firstIsFn||r.firstIsUdf||null===r.first?r._L.isUdf(r.first)&&r.rest.length?(Object.keys(r.argsToApply).length&&r.rest.push(r.argsToApply),r.invoke.apply(r,r.rest)):r.rest.length?void 0:Object.keys(r.argsToApply).length?r.argsToApply._fnArgs:void 0:(r.applyArgs(r.first),Object.keys(r.argsToApply).length&&r.rest.push(r.argsToApply),r.invoke.apply(r,r.rest))}},_L:{flatten:function u(r){var u=function t(r,s){for(var e=0;e<r.length;e++){var n=r[e];Array.isArray(n)?t(n,s):s.push(n)}return s};return u(r,[])},defaults:function(){for(var r=new Array(arguments.length),t=0;t<r.length;++t)r[t]=arguments[t];var s=r.shift();return o(s,r)},memoize:function(r){return i(r)},isFn:function(r){return e(r)},isObj:function(r){return n(r)},isArr:function(r){return Array.isArray(r)},isUdf:function(r){return void 0===r}}});r.exports=function(){for(var r=new Array(arguments.length),t=0;t<r.length;++t)r[t]=arguments[t];if(r.length){var s=new p(this);return s.invoke.apply(s._self,r)}}},function(r,exports){r.exports=require("lodash.isfunction")},function(r,exports){r.exports=require("lodash.isobject")},function(r,exports){r.exports=require("lodash.memoize")},function(r,exports){r.exports=require("lodash.defaults")},function(r,exports){r.exports=require("defclass")}])});